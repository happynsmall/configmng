spring.cloud.loadbalancer.ribbon.enabled: false # disable ribbon. use ReactorLoadBalancerExchangeFilterFunction

spring.cloud.gateway:
  routes: 
  - id: webhook-test1
    uri: lb://webhook
    predicates:
    - Path=/webhook/**   
    filters:
    - RewritePath=/webhook/(?<uri>.*), /${uri}

  - id: happygoods-test1
    uri: lb://happygoods
    predicates:
    - Path=/happygoods/** 

  - id: mdgoods-test1
    uri: lb://mdgoods
    predicates:
    - Path=/mdgoods/** 

# Resilience4J configuration for Resilience4jConfig class
# refer: https://resilience4j.readme.io/docs/circuitbreaker
resilience4j:
  circuitbreaker:
    default:
      # 筌ㅼ뮄�젏 10揶쏉옙 占쎌뒄筌ｏ옙 餓ο옙 占쎌벓占쎈뼗占쎈꺗占쎈즲揶쏉옙 1�룯占� �룯�뜃�궢占쎈립 �뜮袁⑹몛占쎌뵠 70% 占쎌뵠占쎄맒占쎌뵬占쎈르 Circuit Breaker OPEN
      # 占쎈뼊, 5揶쏉옙 占쎌뒄筌ｏ옙繹먮슣占쏙옙�뮉 OPEN占쎈릭筌욑옙 占쎈륫占쎌벉. http timeout占쎌젟筌��굞占� resilience.circuitbreaker.timeout 筌〓챷�� 
      # slowCallDurationThreshold揶쏅�わ옙 http timeout占쎈뻻揶쏄쑬�궖占쎈뼄 占쎌삂占쎈툡占쎈튊 占쎌젫占쏙옙嚥∽옙 占쎈짗占쎌삂占쎈맙. 占쎄쾿筌롳옙, timeout占쎌뵠 �솒�눘占� 獄쏆뮇源�占쎈릭沃섓옙嚥∽옙 占쎌벥沃섎㈇占� 占쎈씨占쎌벉.
      slidingWindowType: COUNT_BASED           # default: COUNT_BASED 
      slidingWindowSize: 10                    # default: 100
      minimumNumberOfCalls: 5                  # default: 100
      failureRateThreshold: 50                 # default: 50
      waitDurationInOpenState: 30000           # default: 60000
      slowCallDurationThreshold: 1000          # default: 60000
      slowCallRateThreshold: 70                # default: 100
      permittedNumberOfCallsInHalfOpenState: 5  #Circuit 占쎄맒占쎄묶揶쏉옙 HALF-OPEN占쎌뵬占쎈르 占쎈�占쎌뒠占쎈┷占쎈뮉 占쎌뒄筌ｏ옙 占쎈땾. default: 10. 癰귢쑬以� 占쎈툧 餓λ쵐�뒄

    custom:
      slidingWindowType: COUNT_BASED 
      slidingWindowSize: 10
      minimumNumberOfCalls: 5
      failureRateThreshold: 60
      waitDurationInOpenState: 10000
      slowCallDurationThreshold: 2000  # slowCall* 鈺곌퀗援뷂옙肉� 占쎈퉸占쎈뼣占쎈┷占쎈즲 fallback 占쎌깈�빊占� 占쎈툧占쎈쭡 
      slowCallRateThreshold: 50
  
  #== http timeout 占쎌젟筌�占�
  # TimeLimiterConfig 占쎈씨占쎌몵筌롳옙, spring.cloud.gateway.routes.metadata.response-timeout 占쎌읅占쎌뒠占쎈쭡
  # metadata.response-timeout 占쎈씨占쎌몵筌롳옙, spring.cloud.gateway.http-client.response-timeout 占쎌읅占쎌뒠占쎈쭡 
  timeout: 
    default: 2500
    custom: 2000        
